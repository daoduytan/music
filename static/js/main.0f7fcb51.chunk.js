(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{122:function(e,t,n){"use strict";n.r(t);var c=n(4),r=n(2),a=n.n(r),i=n(79),u=n.n(i),s=(n(93),n(14)),l=n(29),o=n.n(l),d=n(12),j=n(36),b=n(80),h=n(83),f=n(41),O=n(84),v=n.n(O);function x(){return p.apply(this,arguments)}function p(){return(p=Object(j.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/refresh_token",e.prev=1,e.next=4,v()("/refresh_token",{method:"POST",withCredentials:!0});case 4:return t=e.sent,n=t.data.access_token,e.abrupt("return",n);case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return","");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}var g=function(){var e=Object(j.a)(o.a.mark((function e(){var t,n,c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(t=localStorage.getItem("token")||"")&&0!==t.length){e.next=4;break}return e.abrupt("return","");case 4:if(n=Object(h.a)(t),c=Object(f.get)(n,"exp"),!(!c||Date.now()>=1e3*c)){e.next=12;break}return e.next=10,x();case 10:return r=e.sent,e.abrupt("return",r);case 12:return e.abrupt("return",t);case 15:return e.prev=15,e.t0=e.catch(0),e.abrupt("return","");case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),m="".concat("https://tanmusic.herokuapp.com","/graphql"),k=Object(s.createHttpLink)({uri:m}),w=Object(b.a)(function(){var e=Object(j.a)(o.a.mark((function e(t,n){var c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.headers,e.next=3,g();case 3:return r=e.sent,e.abrupt("return",{headers:Object(d.a)(Object(d.a)({},c),{},{authorization:"Bearer ".concat(r)})});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),y=new s.ApolloClient({link:w.concat(k),cache:new s.InMemoryCache}),S=n(31),M=n(85),C=n(9),z=n(52),N=Object(r.lazy)((function(){return n.e(5).then(n.bind(null,123))})),L=Object(r.lazy)((function(){return n.e(3).then(n.bind(null,124))})),$=Object(r.lazy)((function(){return n.e(4).then(n.bind(null,125))})),R=function(){return Object(c.jsxs)("div",{className:"flex flex-col h-screen",style:{overflow:"hidden"},children:[Object(c.jsx)("div",{style:{flex:1,overflowY:"auto"},children:Object(c.jsx)(M.a,{children:Object(c.jsx)(r.Suspense,{fallback:Object(c.jsx)("div",{children:"Loading..."}),children:Object(c.jsxs)(C.c,{children:[Object(c.jsx)(C.a,{component:L,path:"/",exact:!0}),Object(c.jsx)(C.a,{component:$,path:"/search",exact:!0}),Object(c.jsx)(C.a,{component:N,path:"/signin"}),Object(c.jsx)(C.a,{component:z.a})]})})})}),Object(c.jsx)(z.b,{})]})};var I=function(){return Object(c.jsx)(s.ApolloProvider,{client:y,children:Object(c.jsx)(S.a,{children:Object(c.jsx)(R,{})})})},A=function(e){e&&e instanceof Function&&n.e(6).then(n.bind(null,126)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};u.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(I,{})}),document.getElementById("root")),A()},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var c=n(23),r=n(12),a=n(4),i=n(2),u={audios:[],audio:void 0,link:void 0,loading:!1},s="add/audios",l="audio/select-audio",o="audio/select_link",d=function(e,t){switch(t.type){case s:return Object(r.a)(Object(r.a)({},e),{},{audios:t.payload});case o:return Object(r.a)(Object(r.a)({},e),{},{link:t.payload});case l:return Object(r.a)(Object(r.a)({},e),{},{audio:t.payload});default:return e}},j={state:u,dispatch:function(){}},b=Object(i.createContext)(j),h=function(e){var t=e.children,n=Object(i.useReducer)(d,u),r=Object(c.a)(n,2),s=r[0],l=r[1],o=Object(i.useMemo)((function(){return{state:s,dispatch:l}}),[s,l]);return Object(a.jsx)(b.Provider,{value:o,children:t})},f=function(){var e=Object(i.useContext)(b),t=e.state,n=e.dispatch;return Object(r.a)(Object(r.a)({},t),{},{selectAudio:function(e){n({type:l,payload:e})},addAudio:function(e){n({type:s,payload:e})},selectLink:function(e){n({type:o,payload:e})}})}},40:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return j})),n.d(t,"c",(function(){return d}));var c=n(38),r=n(14);function a(){var e=Object(c.a)(["\n  mutation MusicSearchGet($link: String!) {\n    musicSearchGet(link: $link)\n  }\n"]);return a=function(){return e},e}function i(){var e=Object(c.a)(["\n  mutation SaveMusicSearch(\n    $author: String!\n    $title: String!\n    $avatar: String!\n    $link: String!\n  ) {\n    saveMusicSearch(\n      author: $author\n      title: $title\n      avatar: $avatar\n      link: $link\n    ) {\n      _id\n      author\n      title\n      avatar\n      link\n    }\n  }\n"]);return i=function(){return e},e}function u(){var e=Object(c.a)(["\n  mutation MusicSearch($text: String!) {\n    musicSearch(text: $text) {\n      author\n      title\n      avatar\n      link\n    }\n  }\n"]);return u=function(){return e},e}function s(){var e=Object(c.a)(["\n  query GetMusicList {\n    getMusicList {\n      _id\n      author\n      title\n      avatar\n      link\n    }\n  }\n"]);return s=function(){return e},e}var l=Object(r.gql)(s()),o=Object(r.gql)(u()),d=Object(r.gql)(i()),j=Object(r.gql)(a())},52:function(e,t,n){"use strict";n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return M}));var c=n(23),r=n(4),a=n(14),i=n(2),u=n(31),s=Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Object(r.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),l=Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Object(r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),o=Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),d=n(40),j=n(12),b=n(87),h=function(e){var t=e.children,n=e.size,c=void 0===n?20:n,a=e.onClick,i=Object(b.a)(e,["children","size","onClick"]),u={height:c,width:c};return Object(r.jsx)("div",Object(j.a)(Object(j.a)({className:"inline-block"},i),{},{style:Object(j.a)({},u),onClick:a,children:t}))},f=function(e){var t=e.link,n=Object(i.useState)(!1),a=Object(c.a)(n,2),o=a[0],d=a[1],j=Object(u.b)().selectLink;return Object(r.jsx)(h,{size:30,onClick:function(){d(!o),j(t)},children:o?s:l})},O=function(e){var t=e.music,n=Object(a.useMutation)(d.c),i=Object(c.a)(n,2),u=i[0];i[1].loading;return Object(r.jsx)(h,{size:30,onClick:function(){u({variables:{author:t.author,title:t.title,avatar:t.avatar,link:t.link}}).then((function(e){console.log(e.data)})).catch((function(e){console.log(e)}))},children:o})},v=function(e){var t=e.music;return Object(r.jsxs)("div",{className:"flex py-2 cursor-pointer justify-between items-center hover:bg-green-500 hover:text-white rounded",children:[Object(r.jsxs)("div",{className:"flex items-center p-2",children:[Object(r.jsx)("img",{src:t.avatar,className:"block rounded-lg h-16 w-16",alt:t.title}),Object(r.jsxs)("div",{className:"ml-4",children:[Object(r.jsx)("div",{className:"font-semibold",children:t.title}),Object(r.jsx)("span",{className:"text-xs",children:t.author})]})]}),Object(r.jsxs)("div",{className:"flex px-2",children:[Object(r.jsx)(f,{link:t.link}),Object(r.jsx)(O,{music:t})]})]})},x=function(){return Object(r.jsx)("div",{children:"Not found"})},p=n(41),g=Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Object(r.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}),m=Object(r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:Object(r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),k=function(e){var t=e.onClick,n=e.isPlay,c=void 0!==n&&n?g:m;return Object(r.jsx)("div",{style:{width:50,height:50},onClick:t,children:c})},w=function(e){var t=e.children;return Object(r.jsx)("div",{style:{width:60,textAlign:"center"},children:t})},y=function(e){return"0"===e?"00":e.length<2?"0".concat(e):e},S=function(e){var t=e/60,n=Math.floor(t),c=Math.floor(60*(t-n));return[y(String(n)),y(String(c))]},M=function(){var e=Object(i.useRef)(),t=Object(i.useState)(),n=Object(c.a)(t,2),s=n[0],l=n[1],o=Object(i.useState)(0),j=Object(c.a)(o,2),b=j[0],h=j[1],f=Object(i.useState)(0),O=Object(c.a)(f,2),v=O[0],x=O[1],g=Object(i.useState)(),m=Object(c.a)(g,2),y=m[0],M=m[1],C=Object(u.b)(),z=C.selectLink,N=C.audios,L=C.audio,$=C.link,R=C.selectAudio,I=Object(i.useState)(!1),A=Object(c.a)(I,2),B=A[0],P=A[1],q=Object(a.useMutation)(d.a),F=Object(c.a)(q,2),_=F[0];F[1].loading;Object(i.useEffect)((function(){$&&_({variables:{link:$}}).then((function(e){R(e.data.musicSearchGet)}))}),[$]);var E=Object(i.useCallback)((function(e){var t=Number(e.target.duration.toFixed(2));x(t),l(t)}),[L]),G=b,T=function(){B?(e.current.pause(),clearInterval(y)):(e.current.play(),function(){var e=setInterval((function(){h(G+=1)}),1e3);M(e)}()),P(!B)};if(Object(i.useEffect)((function(){h(0),clearInterval(y),L&&(T(),P(!0),e.current&&setTimeout((function(){e.current.play()}),1e3))}),[L]),Object(i.useEffect)((function(){if(s&&s<=b){h(0),clearInterval(y),P(!B);var e=Object(p.findIndex)(N,(function(e){return e.link===$})),t=N.length;z(e+1===t?N[0].link:N[e+1].link)}}),[s,b,y]),!L)return Object(r.jsx)("div",{});var V=s?100*Number((b/s).toFixed(2)):0;return Object(r.jsxs)("div",{style:{background:"pink"},children:[Object(r.jsxs)("div",{className:"container flex w-full flex-col px-4 items-center mx-auto",style:{height:100},children:[Object(r.jsx)("div",{className:"flex items-center justify-center",children:Object(r.jsx)(k,{onClick:T,isPlay:B})}),Object(r.jsxs)("div",{className:"flex mx-auto w-full max-w-screen-sm items-center",children:[Object(r.jsx)(w,{children:Object(r.jsx)("span",{children:"".concat(S(b)[0],":").concat(S(b)[1])})}),Object(r.jsx)("div",{className:"flex-1 mx-2 rounded h-1 bg-gray-400",children:Object(r.jsx)("div",{className:"rounded h-1 bg-green-500",style:{width:"".concat(V,"%"),transition:"all .3s"}})}),Object(r.jsx)(w,{children:Object(r.jsx)("span",{children:"".concat(S(v)[0],":").concat(S(v)[1])})})]})]}),Object(r.jsx)("audio",{style:{display:"none"},ref:e,onLoadedMetadata:E,src:L,controls:!0,autoPlay:!1})]})}},93:function(e,t,n){}},[[122,1,2]]]);
//# sourceMappingURL=main.0f7fcb51.chunk.js.map