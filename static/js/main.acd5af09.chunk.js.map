{"version":3,"sources":["api/token.ts","api/client.ts","constants/index.ts","routes/routes.tsx","App.tsx","reportWebVitals.ts","index.tsx","context/audio.tsx","query/music.ts","icon/icon.tsx","components/icon/icon.tsx","components/song/song.tsx","components/notfound/notfound.tsx","components/player/play.tsx","components/player/time.tsx","components/player/util.ts","components/player/player.tsx"],"names":["fetchAccessToken","a","axios","method","withCredentials","res","access_token","data","getAccessToken","token","localStorage","getItem","length","decode","jwtDecode","exp","get","Date","now","uri","httpLink","createHttpLink","authLink","setContext","_","headers","authorization","client","ApolloClient","link","concat","cache","InMemoryCache","Signin","lazy","Home","SearchMusic","Routes","className","style","overflow","flex","overflowY","basename","fallback","component","path","exact","NotFound","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById","initialState","audios","audio","undefined","loading","types","reducer","state","action","type","payload","initialContext","dispatch","AudioContext","createContext","ProviderAudioContext","children","useReducer","value","useMemo","Provider","useAudio","useContext","selectAudio","addAudio","selectLink","MUSICS","gql","SEARCH_MUSIC","SAVE_MUSIC","GET_MUSIC_SEARCH","iconPause","xmlns","viewBox","fill","fillRule","d","clipRule","iconPlay","iconHeart","stroke","strokeLinecap","strokeLinejoin","strokeWidth","Icon","size","onClick","props","height","width","Play","useState","isPlay","setIsPlay","Save","music","useMutation","saveMusicSearch","variables","author","title","avatar","console","log","catch","error","Song","src","alt","icon","Time","textAlign","formatNumber","number","formatTime","time","minute","startNumber","Math","floor","endNumber","String","Player","audioRef","useRef","duration","setDuration","timeStart","setTimeStart","timeEnd","setTimeEnd","p","setP","musicSearchGet","useEffect","onLoad","useCallback","e","Number","target","toFixed","m","togglePlayMusic","current","pause","clearInterval","play","t","setInterval","prosessTime","setTimeout","index","findIndex","o","lengthAudios","background","transition","display","ref","onLoadedMetadata","controls","autoPlay"],"mappings":"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","file":"static/js/main.acd5af09.chunk.js","sourcesContent":["import jwtDecode from \"jwt-decode\";\nimport { get } from \"lodash\";\nimport axios from \"axios\";\n\nexport async function fetchAccessToken(): Promise<string> {\n  const url = `/refresh_token`;\n\n  try {\n    const res = await axios(url, {\n      method: \"POST\",\n      withCredentials: true,\n    });\n\n    const { access_token } = res.data;\n\n    return access_token as string;\n  } catch (error) {\n    return \"\";\n  }\n}\n\nexport const getToken = (): string => {\n  const token = localStorage.getItem(\"token\");\n  return token || \"\";\n};\n\nexport const getAccessToken = async (): Promise<string> => {\n  try {\n    const token = getToken();\n\n    if (!token || token.length === 0) return \"\";\n\n    const decode = jwtDecode(token);\n    const exp = get(decode, \"exp\");\n    const isExpired = !exp || Date.now() >= exp * 1000;\n\n    if (isExpired) {\n      const access_token = await fetchAccessToken();\n\n      return access_token;\n    }\n\n    return token;\n  } catch (error) {\n    return \"\";\n  }\n};\n","import { ApolloClient, createHttpLink, InMemoryCache } from \"@apollo/client\";\nimport { setContext } from \"@apollo/client/link/context\";\nimport { API_URL } from \"../constants\";\nimport { getAccessToken } from \"./token\";\n\nconst uri = `${API_URL}/graphql`;\n\nconst httpLink = createHttpLink({\n  uri,\n});\n\nconst authLink = setContext(async (_, { headers }) => {\n  // get the authentication token from local storage if it exists\n  const token = await getAccessToken();\n  // return the headers to the context so httpLink can read them\n  return {\n    headers: {\n      ...headers,\n      authorization: `Bearer ${token}`,\n    },\n  };\n});\n\nconst client = new ApolloClient({\n  link: authLink.concat(httpLink),\n  cache: new InMemoryCache(),\n});\n\nexport { client };\n","const prod = process.env.NODE_ENV === \"production\";\n\nexport const API_URL = prod\n  ? \"https://tanmusic.herokuapp.com\"\n  : \"http://localhost:8080\";\n\nexport const baseUrl = prod ? \"https://daoduytan.github.io/music/\" : \"/\";\n","import { FC, lazy, Suspense } from \"react\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport { NotFound, Player } from \"../components\";\nimport { baseUrl } from \"../constants\";\n\nconst Signin = lazy(() => import(\"../pages/signin/signin\"));\nconst Home = lazy(() => import(\"../pages/home/home\"));\nconst SearchMusic = lazy(() => import(\"../pages/search-music/search-music\"));\n\ninterface Props {}\n\nconst Routes: FC<Props> = () => {\n  return (\n    <div className=\"flex flex-col h-screen\" style={{ overflow: \"hidden\" }}>\n      <div style={{ flex: 1, overflowY: \"auto\" }}>\n        <Router basename={baseUrl}>\n          <Suspense fallback={<div>Loading...</div>}>\n            <Switch>\n              <Route component={Home} path=\"/\" exact />\n              <Route component={SearchMusic} path=\"/search\" exact />\n              <Route component={Signin} path=\"/signin\" />\n              <Route component={NotFound} />\n            </Switch>\n          </Suspense>\n        </Router>\n      </div>\n      <Player />\n    </div>\n  );\n};\n\nexport { Routes };\n","import { ApolloProvider } from \"@apollo/client\";\nimport React from \"react\";\nimport { client } from \"./api\";\nimport { ProviderAudioContext } from \"./context\";\nimport { Routes } from \"./routes\";\n\nfunction App() {\n  return (\n    <ApolloProvider client={client}>\n      <ProviderAudioContext>\n        <Routes />\n      </ProviderAudioContext>\n    </ApolloProvider>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import {\n  createContext,\n  FC,\n  ReactNode,\n  useContext,\n  useMemo,\n  useReducer,\n} from \"react\";\n\ninterface IAction {\n  type: string;\n  payload?: any;\n}\n\ninterface IState {\n  audios: any[];\n  audio?: string;\n  link?: string;\n  loading: boolean;\n}\n\ninterface IContext {\n  state: IState;\n  dispatch: React.Dispatch<any>;\n}\n\nconst initialState = {\n  audios: [],\n  audio: undefined,\n  link: undefined,\n  loading: false,\n};\n\nconst types = {\n  ADD_AUDIOS: \"add/audios\",\n  SELECT_AUDIO: \"audio/select-audio\",\n  SELECT_LINK: \"audio/select_link\",\n};\n\nconst reducer = (state: IState, action: IAction) => {\n  switch (action.type) {\n    case types.ADD_AUDIOS:\n      return {\n        ...state,\n        audios: action.payload,\n      };\n\n    case types.SELECT_LINK:\n      return {\n        ...state,\n        link: action.payload,\n      };\n    case types.SELECT_AUDIO:\n      return {\n        ...state,\n        audio: action.payload,\n      };\n\n    default:\n      return state;\n  }\n};\n\nconst initialContext = {\n  state: initialState,\n  dispatch: () => {},\n};\nconst AudioContext = createContext<IContext>(initialContext);\n\ninterface Props {\n  children: ReactNode;\n}\nconst ProviderAudioContext: FC<Props> = ({ children }) => {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  const value = useMemo(() => ({ state, dispatch }), [state, dispatch]);\n  return (\n    <AudioContext.Provider value={value}>{children}</AudioContext.Provider>\n  );\n};\n\nconst useAudio = () => {\n  const { state, dispatch } = useContext(AudioContext);\n\n  const addAudio = (audios: any[]) => {\n    dispatch({\n      type: types.ADD_AUDIOS,\n      payload: audios,\n    });\n  };\n\n  const selectLink = (link: string) => {\n    dispatch({\n      type: types.SELECT_LINK,\n      payload: link,\n    });\n  };\n\n  const selectAudio = (audio: string) => {\n    dispatch({\n      type: types.SELECT_AUDIO,\n      payload: audio,\n    });\n  };\n\n  return {\n    ...state,\n    selectAudio,\n    addAudio,\n    selectLink,\n  };\n};\n\nexport { ProviderAudioContext, useAudio };\n","import { gql } from \"@apollo/client\";\n\nconst MUSICS = gql`\n  query GetMusicList {\n    getMusicList {\n      _id\n      author\n      title\n      avatar\n      link\n    }\n  }\n`;\n\nconst SEARCH_MUSIC = gql`\n  mutation MusicSearch($text: String!) {\n    musicSearch(text: $text) {\n      author\n      title\n      avatar\n      link\n    }\n  }\n`;\n\nconst SAVE_MUSIC = gql`\n  mutation SaveMusicSearch(\n    $author: String!\n    $title: String!\n    $avatar: String!\n    $link: String!\n  ) {\n    saveMusicSearch(\n      author: $author\n      title: $title\n      avatar: $avatar\n      link: $link\n    ) {\n      _id\n      author\n      title\n      avatar\n      link\n    }\n  }\n`;\n\nconst GET_MUSIC_SEARCH = gql`\n  mutation MusicSearchGet($link: String!) {\n    musicSearchGet(link: $link)\n  }\n`;\n\nexport { MUSICS, SEARCH_MUSIC, GET_MUSIC_SEARCH, SAVE_MUSIC };\n","export const saveIcon = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={2}\n      d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\"\n    />\n  </svg>\n);\n\nexport const iconPause = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 20 20\"\n    fill=\"currentColor\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z\"\n      clipRule=\"evenodd\"\n    />\n  </svg>\n);\n\nexport const iconPlay = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 20 20\"\n    fill=\"currentColor\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z\"\n      clipRule=\"evenodd\"\n    />\n  </svg>\n);\n\nexport const iconHeart = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    fill=\"none\"\n    viewBox=\"0 0 24 24\"\n    stroke=\"currentColor\"\n  >\n    <path\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      strokeWidth={2}\n      d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\"\n    />\n  </svg>\n);\n","import React, { FC, ReactNode } from \"react\";\n\ninterface Props {\n  children: ReactNode;\n  size?: number;\n  onClick?: () => void;\n}\nconst Icon: FC<Props> = ({ children, size = 20, onClick, ...props }) => {\n  const style = {\n    height: size,\n    width: size,\n  };\n\n  return (\n    <div\n      className=\"inline-block\"\n      {...props}\n      style={{ ...style }}\n      onClick={onClick}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport { Icon };\n","import { useMutation } from \"@apollo/client\";\nimport React, { FC, useState } from \"react\";\nimport { useAudio } from \"../../context\";\nimport { iconHeart, iconPause, iconPlay } from \"../../icon\";\nimport { SAVE_MUSIC } from \"../../query\";\nimport { Icon } from \"../icon\";\n\nconst Play: FC<any> = ({ link }) => {\n  const [isPlay, setIsPlay] = useState<boolean>(false);\n  const { selectLink } = useAudio();\n\n  const playMusic = () => {\n    setIsPlay(!isPlay);\n    selectLink(link);\n  };\n\n  return (\n    <Icon size={30} onClick={playMusic}>\n      {isPlay ? iconPause : iconPlay}\n    </Icon>\n  );\n};\n\nconst Save: FC<any> = ({ music }) => {\n  const [saveMusicSearch, { loading }] = useMutation(SAVE_MUSIC);\n  const saveMusic = () => {\n    saveMusicSearch({\n      variables: {\n        author: music.author,\n        title: music.title,\n        avatar: music.avatar,\n        link: music.link,\n      },\n    })\n      .then((data) => {\n        console.log(data.data);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n  return (\n    <Icon size={30} onClick={saveMusic}>\n      {iconHeart}\n    </Icon>\n  );\n};\n\nconst Song: FC<any> = ({ music }) => {\n  return (\n    <div className=\"flex py-2 cursor-pointer justify-between items-center hover:bg-green-500 hover:text-white rounded\">\n      <div className=\"flex items-center p-2\">\n        <img\n          src={music.avatar}\n          className=\"block rounded-lg h-16 w-16\"\n          alt={music.title}\n        />\n        <div className=\"ml-4\">\n          <div className=\"font-semibold\">{music.title}</div>\n          <span className=\"text-xs\">{music.author}</span>\n        </div>\n      </div>\n      <div className=\"flex px-2\">\n        <Play link={music.link} />\n        <Save music={music} />\n      </div>\n    </div>\n  );\n};\nexport { Song };\n","import { FC } from \"react\";\n\ninterface Props {}\n\nconst NotFound: FC<Props> = () => {\n  return <div>Not found</div>;\n};\n\nexport { NotFound };\n","import { FC } from \"react\";\n\ninterface Props {\n  onClick: () => void;\n  isPlay?: boolean;\n}\n\nconst iconPause = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 20 20\"\n    fill=\"currentColor\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z\"\n      clipRule=\"evenodd\"\n    />\n  </svg>\n);\n\nconst iconPlay = (\n  <svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n    viewBox=\"0 0 20 20\"\n    fill=\"currentColor\"\n  >\n    <path\n      fillRule=\"evenodd\"\n      d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z\"\n      clipRule=\"evenodd\"\n    />\n  </svg>\n);\n\nconst Play: FC<Props> = ({ onClick, isPlay = false }) => {\n  const icon = isPlay ? iconPause : iconPlay;\n  return (\n    <div style={{ width: 50, height: 50 }} onClick={onClick}>\n      {icon}\n    </div>\n  );\n};\n\nexport { Play };\n","import { FC, ReactNode } from \"react\";\n\ninterface Props {\n  children: ReactNode;\n}\nconst Time: FC<Props> = ({ children }) => {\n  return <div style={{ width: 60, textAlign: \"center\" }}>{children}</div>;\n};\n\nexport { Time };\n","export const formatNumber = (number: string): string => {\n  if (number === \"0\") return `00`;\n  if (number.length < 2) return `0${number}`;\n  return number;\n};\n\nexport const formatTime = (time: number): string[] => {\n  const minute = time / 60;\n  const startNumber = Math.floor(minute);\n\n  const endNumber = Math.floor((minute - startNumber) * 60);\n\n  return [formatNumber(String(startNumber)), formatNumber(String(endNumber))];\n};\n","import { useMutation } from \"@apollo/client\";\nimport { findIndex } from \"lodash\";\nimport { FC, useCallback, useEffect, useRef, useState } from \"react\";\nimport { useAudio } from \"../../context\";\nimport { GET_MUSIC_SEARCH } from \"../../query\";\nimport { Play } from \"./play\";\nimport { Time } from \"./time\";\nimport { formatTime } from \"./util\";\n\ninterface Props {}\n\nconst HEIGHT = 100;\n\nconst Player: FC<Props> = () => {\n  const audioRef = useRef<any>();\n  const [duration, setDuration] = useState<number>();\n  const [timeStart, setTimeStart] = useState<number>(0);\n  const [timeEnd, setTimeEnd] = useState<number>(0);\n  const [p, setP] = useState<any>();\n  const { selectLink, audios, audio, link, selectAudio } = useAudio();\n  const [isPlay, setIsPlay] = useState<boolean>(false);\n\n  const [musicSearchGet, { loading }] = useMutation(GET_MUSIC_SEARCH);\n\n  useEffect(() => {\n    if (link) {\n      musicSearchGet({\n        variables: { link },\n      }).then((res) => {\n        selectAudio(res.data.musicSearchGet);\n      });\n    }\n  }, [link]);\n\n  const onLoad = useCallback(\n    (e: any) => {\n      const time = Number(e.target.duration.toFixed(2));\n      setTimeEnd(time);\n      setDuration(time);\n    },\n    [audio]\n  );\n\n  let m = timeStart;\n\n  const togglePlayMusic = () => {\n    const prosessTime = () => {\n      const t = setInterval(() => {\n        m = m + 1;\n        setTimeStart(m);\n      }, 1000);\n\n      setP(t);\n    };\n\n    if (!isPlay) {\n      audioRef.current.play();\n      prosessTime();\n    } else {\n      audioRef.current.pause();\n      clearInterval(p);\n    }\n\n    setIsPlay(!isPlay);\n  };\n\n  useEffect(() => {\n    setTimeStart(0);\n    clearInterval(p);\n\n    if (audio) {\n      togglePlayMusic();\n      setIsPlay(true);\n      if (audioRef.current) {\n        setTimeout(() => {\n          audioRef.current.play();\n        }, 1000);\n      }\n    }\n  }, [audio]);\n\n  // end song\n  useEffect(() => {\n    if (duration && duration <= timeStart) {\n      setTimeStart(0);\n      clearInterval(p);\n      setIsPlay(!isPlay);\n\n      const index = findIndex(audios, (o) => o.link === link);\n      const lengthAudios = audios.length;\n\n      if (index + 1 === lengthAudios) {\n        selectLink(audios[0].link);\n      } else {\n        selectLink(audios[index + 1].link);\n      }\n\n      /* setTimeout(() => { */\n      /*   audioRef.current.play(); */\n      /* }, 1000); */\n    }\n  }, [duration, timeStart, p]);\n\n  if (!audio) return <div />;\n\n  const width = duration ? Number((timeStart / duration).toFixed(2)) * 100 : 0;\n\n  return (\n    <div\n      style={{\n        background: \"pink\",\n      }}\n    >\n      <div\n        className=\"container flex w-full flex-col px-4 items-center mx-auto\"\n        style={{ height: HEIGHT }}\n      >\n        <div className=\"flex items-center justify-center\">\n          <Play onClick={togglePlayMusic} isPlay={isPlay} />\n        </div>\n        <div className=\"flex mx-auto w-full max-w-screen-sm items-center\">\n          <Time>\n            <span>{`${formatTime(timeStart)[0]}:${\n              formatTime(timeStart)[1]\n            }`}</span>\n          </Time>\n          <div className=\"flex-1 mx-2 rounded h-1 bg-gray-400\">\n            <div\n              className=\"rounded h-1 bg-green-500\"\n              style={{\n                width: `${width}%`,\n                transition: \"all .3s\",\n              }}\n            />\n          </div>\n          <Time>\n            <span>{`${formatTime(timeEnd)[0]}:${formatTime(timeEnd)[1]}`}</span>\n          </Time>\n        </div>\n      </div>\n      <audio\n        style={{ display: \"none\" }}\n        ref={audioRef}\n        onLoadedMetadata={onLoad}\n        src={audio}\n        controls\n        autoPlay={false}\n      ></audio>\n    </div>\n  );\n};\n\nexport { Player };\n"],"sourceRoot":""}